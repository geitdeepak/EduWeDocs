
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../LAB_04-Implement_Virtual_Networking/">
      
      
        <link rel="next" href="../LAB_06-Implement_Network_Traffic_Management/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Lab-6 Implement Intersite Connectivity - EduWe</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-implement-intersite-connectivity" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="EduWe" class="md-header__button md-logo" aria-label="EduWe" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EduWe
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab-6 Implement Intersite Connectivity
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../azure/" class="md-tabs__link">
          
  
  
  Azure Labs

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../AWS/aws-overview/" class="md-tabs__link">
          
  
  
  AWS Labs

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../GCP/gcp-overview/" class="md-tabs__link">
          
  
  
  GCP Labs

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../azure-trouble/" class="md-tabs__link">
          
  
  
  Troubleshooting

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Blogs/blog1/" class="md-tabs__link">
          
  
  
  Blogs

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contact/" class="md-tabs__link">
        
  
  
    
  
  Contact Us

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="EduWe" class="md-nav__button md-logo" aria-label="EduWe" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    EduWe
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Azure Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Azure Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_01-Manage_Entra_ID_Identities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-1 Manage Microsoft Entra ID Identities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_02a_Manage_Subscriptions_and_RBAC_Entra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-2 Manage Subscriptions and RBAC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_02b-Manage_Governance_via_Azure_Policy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-3 Manage Governance via Azure Policy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_03b-Manage_Azure_Resources_by_Using_ARM_Templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-4 Manage Azure Resources by using Azure Resource Manager Templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_04-Implement_Virtual_Networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-5 Implement Virtual Networking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lab-6 Implement Intersite Connectivity
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lab-6 Implement Intersite Connectivity
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lab-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Lab Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estimated-time-50-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      Estimated Time: 50 Minutes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-scenario" class="md-nav__link">
    <span class="md-ellipsis">
      Lab Scenario
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interactive-lab-simulations" class="md-nav__link">
    <span class="md-ellipsis">
      Interactive Lab Simulations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#job-skills" class="md-nav__link">
    <span class="md-ellipsis">
      Job Skills
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-1-create-a-core-services-virtual-machine-and-virtual-network" class="md-nav__link">
    <span class="md-ellipsis">
      Task 1: Create a core services Virtual Machine and Virtual Network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-2-create-a-virtual-machine-in-a-different-virtual-network" class="md-nav__link">
    <span class="md-ellipsis">
      Task 2: Create a virtual machine in a different virtual network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-3-use-network-watcher-to-test-the-connection-between-virtual-machines" class="md-nav__link">
    <span class="md-ellipsis">
      Task 3: Use Network Watcher to Test the Connection between Virtual Machines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-4-configure-virtual-network-peerings-between-virtual-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Task 4: Configure Virtual Network Peerings between Virtual Networks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-5-use-azure-powershell-to-test-the-connection-between-virtual-machines" class="md-nav__link">
    <span class="md-ellipsis">
      Task 5: Use Azure PowerShell to test the connection between Virtual Machines
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task 5: Use Azure PowerShell to test the connection between Virtual Machines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verify-the-private-ip-address-of-the-coreservicesvm" class="md-nav__link">
    <span class="md-ellipsis">
      Verify the Private IP Address of the CoreServicesVM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-connection-to-the-coreservicesvm-from-the-manufacturingvm" class="md-nav__link">
    <span class="md-ellipsis">
      Test the connection to the CoreServicesVM from the ManufacturingVM.
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-6-create-a-custom-route" class="md-nav__link">
    <span class="md-ellipsis">
      Task 6: Create a custom route
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup-your-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Cleanup your Resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_06-Implement_Network_Traffic_Management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-7 Implement Network Traffic Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_07-Manage_Azure_Storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-8 Manage Azure Storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_08-Manage_Virtual_Machines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-9 Manage Virtual Machines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_09a-Implement_Web_Apps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-10 Implement Web Apps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_09b-Implement_Azure_Container_Instances/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-11 Implement Azure Container Instances (ACI)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_09c-Implement-Azure-Container-Apps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-12 Implement Azure Container Apps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_10-Implement_Data_Protection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-13 Implement Data Protection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_11-Implement_Monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-14 Implement Monitoring
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    AWS Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            AWS Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AWS/aws-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AWS/aws-lab1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AWS/aws-lab2.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AWS/aws-lab3.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-3
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    GCP Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            GCP Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GCP/gcp-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GCP/gcp-lab1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GCP/gcp-lab2.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab-2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Troubleshooting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-trouble/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Troubleshooting Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AWS/aws-trouble/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Troubleshooting Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GCP/gcp-trouble/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GCP Troubleshooting Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Blogs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Blogs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Blogs/blog1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Role of Cloud Computing in Software Developer Life
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Blogs/blog2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud Computing's Impact on Businesses
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Blogs/blog3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployment of WebApp Using Azure App Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Blogs/blog4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Load Distribution Using Azure Load Balancer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Blogs/blog5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Best Practices for Designing Secure Azure Solutions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Blogs/blog6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Choosing the Right Cloud Platform for Your Needs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Blogs/blog7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Azure Security and Compliance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Blogs/blog8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding Computer Networks-The Digital Nervous System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Blogs/blog9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding the OSI Model-The Blueprint of Modern Networking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Blogs/blog10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud Computing-The Backbone of Modern IT Education
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contact/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact Us
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lab-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Lab Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estimated-time-50-minutes" class="md-nav__link">
    <span class="md-ellipsis">
      Estimated Time: 50 Minutes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-scenario" class="md-nav__link">
    <span class="md-ellipsis">
      Lab Scenario
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interactive-lab-simulations" class="md-nav__link">
    <span class="md-ellipsis">
      Interactive Lab Simulations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#job-skills" class="md-nav__link">
    <span class="md-ellipsis">
      Job Skills
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-1-create-a-core-services-virtual-machine-and-virtual-network" class="md-nav__link">
    <span class="md-ellipsis">
      Task 1: Create a core services Virtual Machine and Virtual Network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-2-create-a-virtual-machine-in-a-different-virtual-network" class="md-nav__link">
    <span class="md-ellipsis">
      Task 2: Create a virtual machine in a different virtual network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-3-use-network-watcher-to-test-the-connection-between-virtual-machines" class="md-nav__link">
    <span class="md-ellipsis">
      Task 3: Use Network Watcher to Test the Connection between Virtual Machines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-4-configure-virtual-network-peerings-between-virtual-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Task 4: Configure Virtual Network Peerings between Virtual Networks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-5-use-azure-powershell-to-test-the-connection-between-virtual-machines" class="md-nav__link">
    <span class="md-ellipsis">
      Task 5: Use Azure PowerShell to test the connection between Virtual Machines
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task 5: Use Azure PowerShell to test the connection between Virtual Machines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verify-the-private-ip-address-of-the-coreservicesvm" class="md-nav__link">
    <span class="md-ellipsis">
      Verify the Private IP Address of the CoreServicesVM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-connection-to-the-coreservicesvm-from-the-manufacturingvm" class="md-nav__link">
    <span class="md-ellipsis">
      Test the connection to the CoreServicesVM from the ManufacturingVM.
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-6-create-a-custom-route" class="md-nav__link">
    <span class="md-ellipsis">
      Task 6: Create a custom route
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup-your-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Cleanup your Resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="lab-implement-intersite-connectivity">Lab - Implement Intersite Connectivity<a class="headerlink" href="#lab-implement-intersite-connectivity" title="Permanent link">&para;</a></h1>
<hr />
<h2 id="lab-introduction">Lab Introduction<a class="headerlink" href="#lab-introduction" title="Permanent link">&para;</a></h2>
<p>In this lab you explore communication between virtual networks. You implement virtual network peering and test connections. You will also create a custom route. </p>
<p>This lab requires an Azure subscription. Your subscription type may affect the availability of features in this lab. You may change the region, but the steps are written using <strong>East US</strong>. </p>
<h2 id="estimated-time-50-minutes">Estimated Time: 50 Minutes<a class="headerlink" href="#estimated-time-50-minutes" title="Permanent link">&para;</a></h2>
<h2 id="lab-scenario">Lab Scenario<a class="headerlink" href="#lab-scenario" title="Permanent link">&para;</a></h2>
<p>Adamantus Technologies's segments core IT apps and services (such as DNS and security services) from other parts of the business, including your manufacturing department. However, in some scenarios, apps and services in the core area need to communicate with apps and services in the manufacturing area. In this lab, you configure connectivity between the segmented areas. This is a common scenario for separating production from development or separating one subsidiary from another.  </p>
<h2 id="interactive-lab-simulations">Interactive Lab Simulations<a class="headerlink" href="#interactive-lab-simulations" title="Permanent link">&para;</a></h2>
<p>There are several interactive lab simulations that you might find useful for this topic. The simulation lets you to click through a similar scenario at your own pace. There are differences between the interactive simulation and this lab, but many of the core concepts are the same. An Azure subscription is not required. </p>
<ul>
<li>
<p><a href="https://mslabs.cloudguides.com/guides/AZ-700%20Lab%20Simulation%20-%20Connect%20two%20Azure%20virtual%20networks%20using%20global%20virtual%20network%20peering">Connect two Azure virtual networks using global virtual network peering</a>. Test the connection between two virtual machines in different virtual networks. Create a virtual network peering and retest.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/training/modules/configure-monitoring-virtual-networks/">Configure monitoring for virtual networks</a>. Understand how to use Azure Network Watcher Connection Monitor, flow logs, NSG diagnostics, and packet capture to monitor connectivity across your Azure IaaS network resources.</p>
</li>
<li>
<p><a href="https://mslabs.cloudguides.com/en-us/guides/AZ-104%20Exam%20Guide%20-%20Microsoft%20Azure%20Administrator%20Exercise%209">Implement intersite connectivity</a>. Run a template to create a virtual network infrastructure with several virtual machines. Configure virtual network peerings and test the connections. </p>
</li>
</ul>
<h2 id="architecture-diagram">Architecture Diagram<a class="headerlink" href="#architecture-diagram" title="Permanent link">&para;</a></h2>
<p><img alt="Lab 05 architecture diagram" src="../../media/az104-lab05-architecture.png" /></p>
<h2 id="job-skills">Job Skills<a class="headerlink" href="#job-skills" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Task 1: Create a virtual machine in a virtual network.</strong></li>
<li><strong>Task 2: Create a virtual machine in a different virtual network.</strong></li>
<li><strong>Task 3: Use Network Watcher to test the connection between virtual machines.</strong> </li>
<li><strong>Task 4: Configure virtual network peerings between different virtual networks.</strong></li>
<li><strong>Task 5: Use Azure PowerShell to test the connection between virtual machines.</strong></li>
<li><strong>Task 6: Create a custom route.</strong> </li>
</ul>
<h2 id="task-1-create-a-core-services-virtual-machine-and-virtual-network">Task 1:  Create a core services Virtual Machine and Virtual Network<a class="headerlink" href="#task-1-create-a-core-services-virtual-machine-and-virtual-network" title="Permanent link">&para;</a></h2>
<p>In this task, you create a core services virtual network with a virtual machine. </p>
<ol>
<li>
<p>Sign in to the <strong>Azure portal</strong> - <code>https://portal.azure.com</code>.</p>
</li>
<li>
<p>Search for and select <code>Virtual Machines</code>.</p>
</li>
<li>
<p>From the virtual machines page, select <strong>Create</strong> then select <strong>Azure Virtual Machine</strong>.</p>
</li>
<li>
<p>On the Basics tab, use the following information to complete the form, and then select <strong>Next: Disks &gt;</strong>. For any setting not specified, leave the default value.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Subscription</td>
<td><em>your subscription</em></td>
</tr>
<tr>
<td>Resource group</td>
<td><code>az104-rg5</code> (If necessary, <strong>Create new</strong>. )</td>
</tr>
<tr>
<td>Virtual machine name</td>
<td><code>CoreServicesVM</code></td>
</tr>
<tr>
<td>Region</td>
<td><strong>(US) East US</strong></td>
</tr>
<tr>
<td>Availability options</td>
<td>No infrastructure redundancy required</td>
</tr>
<tr>
<td>Security type</td>
<td><strong>Standard</strong></td>
</tr>
<tr>
<td>Image</td>
<td><strong>Windows Server 2019 Datacenter: x64 Gen2</strong> (notice your other choices)</td>
</tr>
<tr>
<td>Size</td>
<td><strong>Standard_DS2_v3</strong></td>
</tr>
<tr>
<td>Username</td>
<td><code>localadmin</code></td>
</tr>
<tr>
<td>Password</td>
<td><strong>Provide a complex password</strong></td>
</tr>
<tr>
<td>Public inbound ports</td>
<td><strong>None</strong></td>
</tr>
</tbody>
</table>
<p><img alt="Screenshot of Basic virtual machine creation page. " src="../../media/az104-lab05-createcorevm.png" /></p>
</li>
<li>
<p>On the <strong>Disks</strong> tab take the defaults and then select <strong>Next: Networking &gt;</strong>.</p>
</li>
<li>
<p>On the <strong>Networking</strong> tab, for Virtual network, select <strong>Create new</strong>.</p>
</li>
<li>
<p>Use the following information to configure the virtual network, and then select <strong>Ok</strong>. If necessary, remove or replace the existing information.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td><code>CoreServicesVnet</code> (Create new)</td>
</tr>
<tr>
<td>Address range</td>
<td><code>10.0.0.0/16</code></td>
</tr>
<tr>
<td>Subnet Name</td>
<td><code>Core</code></td>
</tr>
<tr>
<td>Subnet address range</td>
<td><code>10.0.0.0/24</code></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Select the <strong>Monitoring</strong> tab. For Boot Diagnostics, select <strong>Disable</strong>.</p>
</li>
<li>
<p>Select <strong>Review + Create</strong>, and then select <strong>Create</strong>.</p>
</li>
<li>
<p>You do not need to wait for the resources to be created. Continue on to the next task.</p>
<blockquote>
<p><strong>Note:</strong> Did you notice in this task you created the virtual network as you created the virtual machine? You could also create the virtual network infrastructure then add the virtual machines. </p>
</blockquote>
</li>
</ol>
<h2 id="task-2-create-a-virtual-machine-in-a-different-virtual-network">Task 2: Create a virtual machine in a different virtual network<a class="headerlink" href="#task-2-create-a-virtual-machine-in-a-different-virtual-network" title="Permanent link">&para;</a></h2>
<p>In this task, you create a manufacturing services virtual network with a virtual machine. </p>
<ol>
<li>
<p>From the Azure portal, search for and navigate to <strong>Virtual Machines</strong>.</p>
</li>
<li>
<p>From the virtual machines page, select <strong>Create</strong> then select <strong>Azure Virtual Machine</strong>.</p>
</li>
<li>
<p>On the Basics tab, use the following information to complete the form, and then select <strong>Next: Disks &gt;</strong>. For any setting not specified, leave the default value.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Subscription</td>
<td><em>your subscription</em></td>
</tr>
<tr>
<td>Resource group</td>
<td><code>az104-rg5</code></td>
</tr>
<tr>
<td>Virtual machine name</td>
<td><code>ManufacturingVM</code></td>
</tr>
<tr>
<td>Region</td>
<td><strong>(US) East US</strong></td>
</tr>
<tr>
<td>Security type</td>
<td><strong>Standard</strong></td>
</tr>
<tr>
<td>Availability options</td>
<td>No infrastructure redundancy required</td>
</tr>
<tr>
<td>Image</td>
<td><strong>Windows Server 2019 Datacenter: x64 Gen2</strong></td>
</tr>
<tr>
<td>Size</td>
<td><strong>Standard_DS2_v3</strong></td>
</tr>
<tr>
<td>Username</td>
<td><code>localadmin</code></td>
</tr>
<tr>
<td>Password</td>
<td><strong>Provide a complex password</strong></td>
</tr>
<tr>
<td>Public inbound ports</td>
<td><strong>None</strong></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>On the <strong>Disks</strong> tab take the defaults and then select <strong>Next: Networking &gt;</strong>.</p>
</li>
<li>
<p>On the Networking tab, for Virtual network, select <strong>Create new</strong>.</p>
</li>
<li>
<p>Use the following information to configure the virtual network, and then select <strong>Ok</strong>.  If necessary, remove or replace the existing address range.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td><code>ManufacturingVnet</code></td>
</tr>
<tr>
<td>Address range</td>
<td><code>172.16.0.0/16</code></td>
</tr>
<tr>
<td>Subnet Name</td>
<td><code>Manufacturing</code></td>
</tr>
<tr>
<td>Subnet address range</td>
<td><code>172.16.0.0/24</code></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Select the <strong>Monitoring</strong> tab. For Boot Diagnostics, select <strong>Disable</strong>.</p>
</li>
<li>
<p>Select <strong>Review + Create</strong>, and then select <strong>Create</strong>.</p>
</li>
</ol>
<h2 id="task-3-use-network-watcher-to-test-the-connection-between-virtual-machines">Task 3: Use Network Watcher to Test the Connection between Virtual Machines<a class="headerlink" href="#task-3-use-network-watcher-to-test-the-connection-between-virtual-machines" title="Permanent link">&para;</a></h2>
<p>In this task, you verify that resources in peered virtual networks can communicate with each other. Network Watcher will be used to test the connection. Before continuing, ensure both virtual machines have been deployed and are running. </p>
<ol>
<li>
<p>From the Azure portal, search for and select <code>Network Watcher</code>.</p>
</li>
<li>
<p>From Network Watcher, in the Network diagnostic tools menu, select <strong>Connection troubleshoot</strong>.</p>
</li>
<li>
<p>Use the following information to complete the fields on the <strong>Connection troubleshoot</strong> page.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Source type</td>
<td><strong>Virtual machine</strong></td>
</tr>
<tr>
<td>Virtual machine</td>
<td><strong>CoreServicesVM</strong></td>
</tr>
<tr>
<td>Destination type</td>
<td><strong>Virtual machine</strong></td>
</tr>
<tr>
<td>Virtual machine</td>
<td><strong>ManufacturingVM</strong></td>
</tr>
<tr>
<td>Preferred IP Version</td>
<td><strong>Both</strong></td>
</tr>
<tr>
<td>Protocol</td>
<td><strong>TCP</strong></td>
</tr>
<tr>
<td>Destination port</td>
<td><code>3389</code></td>
</tr>
<tr>
<td>Source port</td>
<td><em>Blank</em></td>
</tr>
<tr>
<td>Diagnostic tests</td>
<td><em>Defaults</em></td>
</tr>
</tbody>
</table>
<p><img alt="Azure Portal showing Connection Troubleshoot settings." src="../../media/az104-lab05-connection-troubleshoot.png" /></p>
</li>
<li>
<p>Select <strong>Run diagnostic tests</strong>.</p>
<blockquote>
<p><strong>Note</strong>: It may take a couple of minutes for the results to be returned. The screen selections will be greyed out while the results are being collected. Notice the <strong>Connectivity test</strong> shows <strong>UnReachable</strong>. This makes sense because the virtual machines are in different virtual networks. </p>
</blockquote>
</li>
</ol>
<h2 id="task-4-configure-virtual-network-peerings-between-virtual-networks">Task 4: Configure Virtual Network Peerings between Virtual Networks<a class="headerlink" href="#task-4-configure-virtual-network-peerings-between-virtual-networks" title="Permanent link">&para;</a></h2>
<p>In this task, you create a virtual network peering to enable communications between resources in the virtual networks. </p>
<ol>
<li>
<p>In the Azure portal, select the <code>CoreServicesVnet</code> virtual network.</p>
</li>
<li>
<p>In CoreServicesVnet, under <strong>Settings</strong>, select <strong>Peerings</strong>.</p>
</li>
<li>
<p>On CoreServicesVnet | Peerings, select <strong>+ Add</strong>. If not specified, take the default. </p>
</li>
</ol>
<table>
<thead>
<tr>
<th><strong>Parameter</strong></th>
<th><strong>Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Peering link name</td>
<td><code>CoreServicesVnet-to-ManufacturingVnet</code></td>
</tr>
<tr>
<td>Virtual network</td>
<td><strong>ManufacturingVM-net (az104-rg5)</strong></td>
</tr>
<tr>
<td>Allow ManufacturingVnet to access CoreServicesVnet</td>
<td>selected (default)</td>
</tr>
<tr>
<td>Allow ManufacturingVnet to receive forwarded traffic from CoreServicesVnet</td>
<td>selected</td>
</tr>
<tr>
<td>Peering link name</td>
<td><code>ManufacturingVnet-to-CoreServicesVnet</code></td>
</tr>
<tr>
<td>Allow CoreServicesVnet to access the peered virtual network</td>
<td>selected (default)</td>
</tr>
<tr>
<td>Allow CoreServicesVnet to receive forwarded traffic from the peered virtual network</td>
<td>selected</td>
</tr>
</tbody>
</table>
<ol>
<li>
<p>In CoreServicesVnet | Peerings, verify that the <strong>CoreServicesVnet-to-ManufacturingVnet</strong> peering is listed. Refresh the page to ensure the <strong>Peering status</strong> is <strong>Connected</strong>.</p>
</li>
<li>
<p>Switch to the <strong>ManufacturingVnet</strong> and verify the <strong>ManufacturingVnet-to-CoreServicesVnet</strong> peering is listed. Ensure the <strong>Peering status</strong> is <strong>Connected</strong>. You may need to <strong>Refresh</strong> the page. </p>
</li>
</ol>
<h2 id="task-5-use-azure-powershell-to-test-the-connection-between-virtual-machines">Task 5: Use Azure PowerShell to test the connection between Virtual Machines<a class="headerlink" href="#task-5-use-azure-powershell-to-test-the-connection-between-virtual-machines" title="Permanent link">&para;</a></h2>
<p>In this task, you retest the connection between the virtual machines in different virtual networks. </p>
<h3 id="verify-the-private-ip-address-of-the-coreservicesvm">Verify the Private IP Address of the CoreServicesVM<a class="headerlink" href="#verify-the-private-ip-address-of-the-coreservicesvm" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>From the Azure portal, search for and select the <code>CoreServicesVM</code> virtual machine.</p>
</li>
<li>
<p>On the <strong>Overview</strong> blade, in the <strong>Networking</strong> section, record the <strong>Private IP address</strong> of the machine. You need this information to test the connection.</p>
</li>
</ol>
<h3 id="test-the-connection-to-the-coreservicesvm-from-the-manufacturingvm">Test the connection to the CoreServicesVM from the <strong>ManufacturingVM</strong>.<a class="headerlink" href="#test-the-connection-to-the-coreservicesvm-from-the-manufacturingvm" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>Did you know?</strong> There are many ways to check connections. In this task, you use <strong>Run command</strong>. You could also continue to use Network Watcher. Or you could use a Remote Desktop Connection to the access the virtual machine. Once connected, use <strong>test-connection</strong>. As you have time, give RDP a try. </p>
</blockquote>
<ol>
<li>
<p>Switch to the <code>ManufacturingVM</code> virtual machine.</p>
</li>
<li>
<p>In the <strong>Operations</strong> blade, select the <strong>Run command</strong> blade.</p>
</li>
<li>
<p>Select <strong>RunPowerShellScript</strong> and run the <strong>Test-NetConnection</strong> command. Be sure to use the private IP address of the <strong>CoreServicesVM</strong>.</p>
<p><code>Powershell
Test-NetConnection &lt;CoreServicesVM private IP address&gt; -port 3389</code>
1. It may take a couple of minutes for the script to time out. The top of the page shows an informational message <em>Script execution in progress.</em></p>
</li>
<li>
<p>The test connection should succeed because peering has been configured. Your computer name and remote address in this graphic may be different. </p>
</li>
</ol>
<p><img alt="PowerShell window with Test-NetConnection succeeded." src="../../media/az104-lab05-success.png" /></p>
<h2 id="task-6-create-a-custom-route">Task 6: Create a custom route<a class="headerlink" href="#task-6-create-a-custom-route" title="Permanent link">&para;</a></h2>
<p>In this task, you want to control network traffic between the perimeter subnet and the internal core services subnet. A virtual network appliance will be installed in the core services subnet and all traffic should be routed there. </p>
<ol>
<li>
<p>Search for select the <code>CoreServicesVnet</code>.</p>
</li>
<li>
<p>Select <strong>Subnets</strong> and then <strong>+ Create</strong>. Be sure to <strong>Save</strong> your changes. </p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td><code>perimeter</code></td>
</tr>
<tr>
<td>Subnet address range</td>
<td><code>10.0.1.0/24</code></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>In the Azure portal, search for and select <code>Route tables</code>, and then select <strong>Create</strong>. </p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Subscription</td>
<td>your subscription</td>
</tr>
<tr>
<td>Resource group</td>
<td><code>az104-rg5</code></td>
</tr>
<tr>
<td>Region</td>
<td><strong>East US</strong></td>
</tr>
<tr>
<td>Name</td>
<td><code>rt-CoreServices</code></td>
</tr>
<tr>
<td>Propagate gateway routes</td>
<td><strong>No</strong></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>After the route table deploys, select <strong>Go to resource</strong>.</p>
</li>
<li>
<p>Select <strong>Routes</strong> and then <strong>+ Add</strong>. Create a route from a future Network Virtual Appliance (NVA) to the CoreServices virtual network. </p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Route name</td>
<td><code>PerimetertoCore</code></td>
</tr>
<tr>
<td>Destination type</td>
<td><strong>IP Addresses</strong></td>
</tr>
<tr>
<td>Destination IP addresses</td>
<td><code>10.0.0.0/16</code> (core services virtual network)</td>
</tr>
<tr>
<td>Next hop type</td>
<td><strong>Virtual appliance</strong> (notice your other choices)</td>
</tr>
<tr>
<td>Next hop address</td>
<td><code>10.0.1.7</code> (future NVA)</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Select <strong>+ Add</strong> when the route is completed. The last thing to do is associate the route with the subnet.</p>
</li>
<li>
<p>Select <strong>Subnets</strong> and then <strong>Associate</strong>. Complete the configuration.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Virtual network</td>
<td><strong>CoreServicesVnet</strong></td>
</tr>
<tr>
<td>Subnet</td>
<td><strong>Core</strong></td>
</tr>
</tbody>
</table>
</li>
</ol>
<blockquote>
<p><strong>Note</strong>: You have created a user defined route to direct traffic from the DMZ to the new NVA.  </p>
</blockquote>
<h2 id="cleanup-your-resources">Cleanup your Resources<a class="headerlink" href="#cleanup-your-resources" title="Permanent link">&para;</a></h2>
<p>If you are working with <strong>your own subscription</strong> take a minute to delete the lab resources. This will ensure resources are freed up and cost is minimized. The easiest way to delete the lab resources is to delete the lab resource group. </p>
<ul>
<li>In the Azure portal, select the resource group, select <strong>Delete the resource group</strong>, <strong>Enter resource group name</strong>, and then click <strong>Delete</strong>.</li>
<li>Using Azure PowerShell, <code>Remove-AzResourceGroup -Name resourceGroupName</code>.</li>
<li>Using the CLI, <code>az group delete --name resourceGroupName</code>.</li>
</ul>
<h2 id="key-takeaways">Key Takeaways<a class="headerlink" href="#key-takeaways" title="Permanent link">&para;</a></h2>
<p>Congratulations on completing the lab. Here are the main takeaways for this lab. </p>
<ul>
<li>By default, resources in different virtual networks cannot communicate.</li>
<li>Virtual network peering enables you to seamlessly connect two or more virtual networks in Azure.</li>
<li>Peered virtual networks appear as one for connectivity purposes.</li>
<li>The traffic between virtual machines in peered virtual networks uses the Microsoft backbone infrastructure.</li>
<li>System defined routes are automatically created for each subnet in a virtual network. User-defined routes override or add to the default system routes. </li>
<li>Azure Network Watcher provides a suite of tools to monitor, diagnose, and view metrics and logs for Azure IaaS resources.</li>
</ul>
<hr />
<div style="text-align: center; padding-top: 30px;">
  <img src="/images/logo.png" alt="EduWe Logo" style="max-width: 150px; height: auto;">
  <p>
  <center><strong>Ceekh Edunix Pvt Ltd</strong></center><br>
    Address: H-34, Ground Floor, Sector 63, Noida, Uttar Pradesh<br>
    Email: <a href="mailto:info@ceekh.com" style="color: #007bff;">info@ceekh.com</a>
  </p>
  <p style="font-size: 14px; color: #555;"><center> 2025 EduWe. All rights reserved.| Developed by Deepak Kumar Tyagi </center></p>
</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://www.linkedin.com" target="_blank" rel="noopener" title="LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.twitter.com" target="_blank" rel="noopener" title="Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.facebook.com" target="_blank" rel="noopener" title="Facebook" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.youtube.com/@eduwe8400" target="_blank" rel="noopener" title="YouTube" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:info@ceekh.com" target="_blank" rel="noopener" title="Email" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "navigation.expand", "header.autohide", "content.code.copy", "content.action.edit", "content.tooltips"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>